<!doctype html>
<html>
<head>
	<title>Visualization of food consumption and daily nutrition</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="client.js"></script>
  <!-- include A-Frame obviously -->
  <script src="https://aframe.io/releases/0.6.0/aframe.min.js"></script>
  <!-- include ar.js for A-Frame -->
  <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script> 
  <script src=""https://unpkg.com/aframe-animation-component@^4.1.2/dist/aframe-animation-component.min.jsâ€></script>
  <script src="js/three.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  <style>
  body { margin: 5px; padding: 0; box-sizing: border-box; }
  body { font: 13px Helvetica, Arial; }
  form { background: #000; padding: 3px; position: fixed; bottom: 0; width: 100%; }
  form input { border: 0; padding: 10px; width: 90%; margin-right: .5%; }
  form button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 10px; }
  #scale-data-milk, #scale-data-broccoli, #scale-data-fish, #scale-data-orange, #scale-data-meat { font-size: 28px; pointer-events: auto!important;}
  .progress-bar-vertical { display: inline-block; width: 150px; height: 40px; -webkit-transform: rotate(-90deg); /* Chrome, Safari, Opera */ transform: rotate(-90deg);}
</style>
<script>
  AFRAME.registerComponent('reset-on-click', {
    init: function () {
      this.el.addEventListener('click', function (evt) {
        console.log("Reset virtual scene");
        resetVirtualScene();
      });
    }
  });
</script>
</head> 
<body>

  <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false;'>
    <!-- define a camera which will move according to the marker position -->

    <!-- marker milk -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/milk.patt'>
      <a-sphere id="milk3D" position='0 0.1 0' radius="0.2" material="opacity: 1.0; color: #4CC3D9"></a-sphere>

      <a-text id="milkText" position="-0.6 1 -0.6" rotation="-90 0 0"  value="Milk" color="#D05A6E"></a-text>
      <a-text id="milkWeight" position="0.1 1 -0.6" rotation="-90 0 0" value="0 g" color="#D05A6E"></a-text>
      <a-text id="simulateMilkText" position="-0.6 1 -0.9" rotation="-90 0 0"  value="Simula" color="#1B813E"></a-text>
      <a-text id="simulateMilkWeight" position="0.1 1 -0.9" rotation="-90 0 0" value="0 g" color="#1B813E"></a-text>     

      <a-plane id ="milkPlane" position="0 0.5 0.1" rotation="-90 0 0" width="2" height="2" color="#a3b7ae" visible = "false"></a-plane>

      <a-box id="milkHistory0" position='-0.55 1 0.7' depth="0.2" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="milkHistory1" position='-0.3 1 0.3' depth="1" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="milkHistory2" position='0 1 0.6' depth="0.4" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="milkHistory3" position='0.3 1 0.55' depth="0.5" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="milkHistory4" position='0.55 1 0.5' depth="0.6" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>

      <a-entity id="milkHistoryText0" position="-0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="milkHistoryText1" position="-0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="milkHistoryText2" position="0 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="milkHistoryText3" position="0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="milkHistoryText4" position="0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-entity id="milkHistoryNumberText0" position="-0.55 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="milkHistoryNumberText1" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="milkHistoryNumberText2" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="milkHistoryNumberText3" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="milkHistoryNumberText4" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

    </a-marker>

    <!-- marker orange -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/orange.patt'>
      <a-sphere id="orange3D" position='0 0.1 0' radius="0.2" material="color: #ff953f"></a-sphere>

      <a-text id="orangeText" position="-0.7 1 -0.6" rotation="-90 0 0" value="Orange" color="#D05A6E"></a-text>
      <a-text id="orangeWeight" position="0.1 1 -0.6" rotation="-90 0 0" value="0 g" color="#D05A6E"></a-text>
      <a-text id="simulateOrangeText" position="-0.7 1 -0.9" rotation="-90 0 0" value="Simula" color="#1B813E"></a-text>
      <a-text id="simulateOrangeWeight" position="0.1 1 -0.9" rotation="-90 0 0" value="0 g" color="#1B813E"></a-text>

      <a-plane id ="orangePlane" position="0 0.5 0.1" rotation="-90 0 0" width="2" height="2" color="#a3b7ae" visible = "false"></a-plane>

      <a-box id="orangeHistory0" position='-0.55 1 0.7' depth="0.2" height="0.1" width="0.1" color="#ff953f" visible="false"></a-box>
      <a-box id="orangeHistory1" position='-0.3 1 0.3' depth="1" height="0.1" width="0.1" color="#ff953f" visible="false"></a-box>
      <a-box id="orangeHistory2" position='0 1 0.6' depth="0.4" height="0.1" width="0.1" color="#ff953f" visible="false"></a-box>
      <a-box id="orangeHistory3" position='0.3 1 0.55' depth="0.5" height="0.1" width="0.1" color="#ff953f" visible="false"></a-box>
      <a-box id="orangeHistory4" position='0.55 1 0.5' depth="0.6" height="0.1" width="0.1" color="#ff953f" visible="false"></a-box>

      <a-entity id="orangeHistoryText0" position="-0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeHistoryText1" position="-0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeHistoryText2" position="0 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeHistoryText3" position="0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeHistoryText4" position="0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-entity id="orangeHistoryNumberText0" position="-0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeHistoryNumberText1" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeHistoryNumberText2" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeHistoryNumberText3" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeHistoryNumberText4" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

    </a-marker>

    <!-- marker meat -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/meat.patt'>
      <a-sphere id="meat3D" position='0 0.1 0' radius="0.2" color="#d31d08"></a-sphere>

      <a-text id="meatText" position="-0.6 1 -0.6" rotation="-90 0 0" value="Meat" color="#D05A6E"></a-text>
      <a-text id="meatWeight" position="0.1 1 -0.6" rotation="-90 0 0" value="0 g" color="#D05A6E"></a-text>
      <a-text id="simulateMeatText" position="-0.6 1 -0.9" rotation="-90 0 0" value="Simula" color="#1B813E"></a-text>
      <a-text id="simulateMeatWeight" position="0.1 1 -0.9" rotation="-90 0 0" value="0 g" color="#1B813E"></a-text>

      <a-plane id ="meatPlane" position="0 0.5 0.1" rotation="-90 0 0" width="2" height="2" color="#a3b7ae" visible = "false"></a-plane>

      <a-box id="meatHistory0" position='-0.55 1 0.8' depth="1" height="0.1" width="0.1" color="#d31d08" visible="false"></a-box>
      <a-box id="meatHistory1" position='-0.3 1 0.8' depth="1" height="0.1" width="0.1" color="#d31d08" visible="false"></a-box>
      <a-box id="meatHistory2" position='0 1 0.8' depth="1" height="0.1" width="0.1" color="#d31d08" visible="false"></a-box>
      <a-box id="meatHistory3" position='0.3 1 0.8' depth="1" height="0.1" width="0.1" color="#d31d08" visible="false"></a-box>
      <a-box id="meatHistory4" position='0.55 1 0.8' depth="1" height="0.1" width="0.1" color="#d31d08" visible="false"></a-box>

      <a-entity id="meatHistoryText0" position="-0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatHistoryText1" position="-0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatHistoryText2" position="0 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatHistoryText3" position="0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatHistoryText4" position="0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-entity id="meatHistoryNumberText0" position="-0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatHistoryNumberText1" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatHistoryNumberText2" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatHistoryNumberText3" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatHistoryNumberText4" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

    </a-marker>

    <!-- marker broccoli -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/broccoli.patt'>
      <a-sphere id ="broccoli3D" position="0 0.1 0" radius="0.2" color="#1B813E"></a-sphere>

      <a-text id="broccoliText" position="-0.75 1 -0.6" rotation="-90 0 0" value="Broccoli" color="#D05A6E"></a-text>
      <a-text id="broccoliWeight" position="0.1 1 -0.6" rotation="-90 0 0" value="0 g" color="#D05A6E"></a-text>
      <a-text id="simulatBroccoliText" position="-0.75 1 -0.9" rotation="-90 0 0" value="Simula" color="#1B813E"></a-text>
      <a-text id="simulateBroccoliWeight" position="0.1 1 -0.9" rotation="-90 0 0" value="0 g" color="#1B813E"></a-text>

      <a-plane id ="broccoliPlane" position="0 0.5 0.1" rotation="-90 0 0" width="2" height="2" color="#a3b7ae" visible = "false"></a-plane>

      <a-box id="broccoliHistory0" position='-0.55 1 0.8' depth="1" height="0.1" width="0.1" color="#1B813E" visible="false"></a-box>
      <a-box id="broccoliHistory1" position='-0.3 1 0.8' depth="1" height="0.1" width="0.1" color="#1B813E" visible="false"></a-box>
      <a-box id="broccoliHistory2" position='0 1 0.8' depth="1" height="0.1" width="0.1" color="#1B813E" visible="false"></a-box>
      <a-box id="broccoliHistory3" position='0.3 1 0.8' depth="1" height="0.1" width="0.1" color="#1B813E" visible="false"></a-box>
      <a-box id="broccoliHistory4" position='0.55 1 0.8' depth="1" height="0.1" width="0.1" color="#1B813E" visible="false"></a-box>

      <a-entity id="broccoliHistoryText0" position="-0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliHistoryText1" position="-0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliHistoryText2" position="0 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliHistoryText3" position="0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliHistoryText4" position="0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-entity id="broccoliHistoryNumberText0" position="-0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliHistoryNumberText1" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliHistoryNumberText2" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliHistoryNumberText3" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliHistoryNumberText4" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

    </a-marker>

    <!-- marker fish -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/fish.patt'>
      <a-sphere id="fish3D" position="0 0.1 0" radius="0.2" color="#99A6A6"></a-sphere>

      <a-text id="fishText" position="-0.6 1 -0.6" rotation="-90 0 0" value="Fish" color="#D05A6E"></a-text>
      <a-text id="fishWeight" position="0.1 1 -0.6" rotation="-90 0 0" value="0 g" color="#D05A6E"></a-text>
      <a-text id="simulatFishText" position="-0.6 1 -0.9" rotation="-90 0 0" value="Simula" color="#1B813E"></a-text>
      <a-text id="simulateFishWeight" position="0.1 1 -0.9" rotation="-90 0 0" value="0 g" color="#1B813E"></a-text>

      <a-plane id ="fishPlane" position="0 0.5 0.1" rotation="-90 0 0" width="2" height="2" color="#a3b7ae" visible = "false"></a-plane>

      <a-box id="fishHistory0" position='-0.55 1 0.8' depth="1" height="0.1" width="0.1" color="#99A6A6" visible="false"></a-box>
      <a-box id="fishHistory1" position='-0.3 1 0.8' depth="1" height="0.1" width="0.1" color="#99A6A6" visible="false"></a-box>
      <a-box id="fishHistory2" position='0 1 0.8' depth="1" height="0.1" width="0.1" color="#99A6A6" visible="false"></a-box>
      <a-box id="fishHistory3" position='0.3 1 0.8' depth="1" height="0.1" width="0.1" color="#99A6A6" visible="false"></a-box>
      <a-box id="fishHistory4" position='0.55 1 0.8' depth="1" height="0.1" width="0.1" color="#99A6A6" visible="false"></a-box>

      <a-entity id="fishHistoryText0" position="-0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishHistoryText1" position="-0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishHistoryText2" position="0 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishHistoryText3" position="0.3 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishHistoryText4" position="0.55 1 1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-entity id="fishHistoryNumberText0" position="-0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishHistoryNumberText1" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishHistoryNumberText2" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishHistoryNumberText3" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishHistoryNumberText4" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>
      
    </a-marker>


    <!-- marker nutrition Calcium -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/ca.patt'>
      <a-text id="calciumText" position="-0.7 0 -0.7" rotation="-90 0 0" value="Ca" color="#D05A6E"></a-text>
      <a-text id="calciumAmount" position="-0.15 0 -0.7" rotation="-90 0 0" value="1000 mg" color="#D05A6E"></a-text>

      <a-box id="milkNutrition0" position='-0.55 1 0.7' depth="0.2" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="orangeNutrition0" position='-0.3 1 0.3' depth="1" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="meatNutrition0" position='0 1 0.6' depth="0.4" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="broccoliNutrition0" position='0.3 1 0.55' depth="0.5" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="fishNutrition0" position='0.55 1 0.5' depth="0.6" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>

      <a-entity id="milkNutritionText0" position="-0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Milk; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionText0" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Orange; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionText0" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Meat; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionText0" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Broccoli; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionText0" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Fish; width: 1.6; " visible="false"></a-entity>

      <a-entity id="milkNutritionNumberText0" position="-0.55 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionNumberText0" position="-0.3 1 0.1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionNumberText0" position="0 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionNumberText0" position="0.3 1 0.45"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionNumberText0" position="0.55 1 0.4"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-box id="intake" position='0.15 3.2 -1' depth="0.1" height="0.01" width="0.4" color="#58e34b"></a-box>
      <a-text id="intakeText" position="-0.35 3.2 -1.5" rotation="-45 0 0" value="1000 mg" color="#4fcc43"></a-text>

      <a-box id="virtualNutritionBarCalcium" position='0.7 0.5 -1.5' depth="0.2" height="1" width="0.2" color="#4CC3D9" visible="false"></a-box>
      <a-text id="virtualNutritionBarCalciumNumber" position="0.2 1.5 -1.5" rotation="-45 0 0" value="1000 mg" color="#D05A6E" visible="false"></a-text>

    </a-marker>

    <!-- marker nutrition Calories -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/cal.patt'>
      <a-text id="caloriesText" position="-0.7 0 -0.7" rotation="-90 0 0" value="Cals" color="#D05A6E"></a-text>
      <a-text id="caloriesAmount" position="-0.1 0 -0.7" rotation="-90 0 0" value="1000 Cal" color="#D05A6E"></a-text>

      <a-box id="milkNutrition1" position='-0.55 1 0.7' depth="0.2" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="orangeNutrition1" position='-0.3 1 0.3' depth="1" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="meatNutrition1" position='0 1 0.6' depth="0.4" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="broccoliNutrition1" position='0.3 1 0.55' depth="0.5" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="fishNutrition1" position='0.55 1 0.5' depth="0.6" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>

      <a-entity id="milkNutritionText1" position="-0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Milk; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionText1" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Orange; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionText1" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Meat; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionText1" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Broccoli; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionText1" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Fish; width: 1.6; " visible="false"></a-entity>

      <a-entity id="milkNutritionNumberText1" position="-0.55 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionNumberText1" position="-0.3 1 0.1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionNumberText1" position="0 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionNumberText1" position="0.3 1 0.45"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionNumberText1" position="0.55 1 0.4"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-box id="intake" position='0.15 3.2 -1' depth="0.1" height="0.01" width="0.4" color="#58e34b"></a-box>
      <a-text id="intakeText" position="-0.35 3.2 -1.5" rotation="-45 0 0" value="2000 Cal" color="#4fcc43"></a-text>

      <a-box id="virtualNutritionBarCalories" position='0.7 0.5 -1.5' depth="0.2" height="1" width="0.2" color="#4CC3D9" visible="false"></a-box>
      <a-text id="virtualNutritionBarCaloriesNumber" position="0.2 1.5 -1.5" rotation="-45 0 0" value="1000 Cal" color="#D05A6E" visible="false"></a-text>

    </a-marker>

    <!-- marker nutrition Fat -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/fat.patt'>
      <a-text id="fatText" position="-0.55 0 -0.7" rotation="-90 0 0" value="Fat" color="#D05A6E"></a-text>
      <a-text id="fatAmount" position="0 0 -0.7" rotation="-90 0 0" value="60 g" color="#D05A6E"></a-text>

      <a-box id="milkNutrition2" position='-0.55 1 0.7' depth="0.2" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="orangeNutrition2" position='-0.3 1 0.3' depth="1" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="meatNutrition2" position='0 1 0.6' depth="0.4" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="broccoliNutrition2" position='0.3 1 0.55' depth="0.5" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="fishNutrition2" position='0.55 1 0.5' depth="0.6" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>

      <a-entity id="milkNutritionText2" position="-0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Milk; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionText2" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Orange; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionText2" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Meat; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionText2" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Broccoli; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionText2" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Fish; width: 1.6; " visible="false"></a-entity>

      <a-entity id="milkNutritionNumberText2" position="-0.55 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionNumberText2" position="-0.3 1 0.1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionNumberText2" position="0 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionNumberText2" position="0.3 1 0.45"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionNumberText2" position="0.55 1 0.4"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-box id="intake" position='0.15 3.2 -1' depth="0.1" height="0.01" width="0.4" color="#58e34b"></a-box>
      <a-text id="intakeText" position="-0.1 3.2 -1.5" rotation="-45 0 0" value="70 g" color="#4fcc43"></a-text>

      <a-box id="virtualNutritionBarFat" position='0.7 0.5 -1.5' depth="0.2" height="1" width="0.2" color="#4CC3D9" visible="false"></a-box>
      <a-text id="virtualNutritionBarFatNumber" position="0.45 1.5 -1.5" rotation="-45 0 0" value="30 g" color="#D05A6E" visible="false"></a-text>

    </a-marker>

    <!-- marker nutrition Protein -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/protein.patt'>
      <a-text id="proteinText" position="-0.8 0 -0.7" rotation="-90 0 0" value="Protein" color="#D05A6E"></a-text>
      <a-text id="proteinAmount" position="0.1 0 -0.7" rotation="-90 0 0" value="30 g" color="#D05A6E"></a-text>

      <a-box id="milkNutrition3" position='-0.55 1 0.7' depth="0.2" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="orangeNutrition3" position='-0.3 1 0.3' depth="1" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="meatNutrition3" position='0 1 0.6' depth="0.4" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="broccoliNutrition3" position='0.3 1 0.55' depth="0.5" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="fishNutrition3" position='0.55 1 0.5' depth="0.6" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>

      <a-entity id="milkNutritionText3" position="-0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Milk; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionText3" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Orange; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionText3" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Meat; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionText3" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Broccoli; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionText3" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Fish; width: 1.6; " visible="false"></a-entity>

      <a-entity id="milkNutritionNumberText3" position="-0.55 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionNumberText3" position="-0.3 1 0.1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionNumberText3" position="0 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionNumberText3" position="0.3 1 0.45"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionNumberText3" position="0.55 1 0.4"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-box id="intake" position='0.15 3.2 -1' depth="0.1" height="0.01" width="0.4" color="#58e34b"></a-box>
      <a-text id="intakeText" position="-0.1 3.2 -1.5" rotation="-45 0 0" value="56 g" color="#4fcc43"></a-text>

      <a-box id="virtualNutritionBarProtein" position='0.7 0.5 -1.5' depth="0.2" height="1" width="0.2" color="#4CC3D9" visible="false"></a-box>
      <a-text id="virtualNutritionBarProteinNumber" position="0.45 1.5 -1.5" rotation="-45 0 0" value="60 g" color="#D05A6E" visible="false"></a-text>

    </a-marker>

    <!-- marker nutrition vitaminC -->
    <a-marker preset='custom' type='pattern' url='https://raw.githubusercontent.com/jjxie/SocketSensorTest/master/ARmarkers/vitaminC.patt'>
      <a-text id="vitaminCText" position="-0.55 0 -0.7" rotation="-90 0 0" value="VC" color="#D05A6E"></a-text>
      <a-text id="vitaminCAmount" position="0 0 -0.7" rotation="-90 0 0" value="30 mg" color="#D05A6E"></a-text>

      <a-box id="milkNutrition4" position='-0.55 1 0.7' depth="0.2" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="orangeNutrition4" position='-0.3 1 0.3' depth="1" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="meatNutrition4" position='0 1 0.6' depth="0.4" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="broccoliNutrition4" position='0.3 1 0.55' depth="0.5" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>
      <a-box id="fishNutrition4" position='0.55 1 0.5' depth="0.6" height="0.1" width="0.1" color="#4CC3D9" visible="false"></a-box>

      <a-entity id="milkNutritionText4" position="-0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Milk; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionText4" position="-0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Orange; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionText4" position="0 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Meat; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionText4" position="0.3 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Broccoli; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionText4" position="0.55 1 0.9"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: Fish; width: 1.6; " visible="false"></a-entity>

      <a-entity id="milkNutritionNumberText4" position="-0.55 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 1; width: 1.6; " visible="false"></a-entity>
      <a-entity id="orangeNutritionNumberText4" position="-0.3 1 0.1"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 2; width: 1.6; " visible="false"></a-entity>
      <a-entity id="meatNutritionNumberText4" position="0 1 0.5"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 3; width: 1.6; " visible="false"></a-entity>
      <a-entity id="broccoliNutritionNumberText4" position="0.3 1 0.45"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 4; width: 1.6; " visible="false"></a-entity>
      <a-entity id="fishNutritionNumberText4" position="0.55 1 0.4"  rotation="-90 0 0" text="color: #D05A6E; align: center; value: 5; width: 1.6; " visible="false"></a-entity>

      <a-box id="intake" position='0.15 3.2 -1' depth="0.1" height="0.01" width="0.4" color="#58e34b"></a-box>
      <a-text id="intakeText" position="-0.15 3.2 -1.5" rotation="-45 0 0" value="90 mg" color="#4fcc43"></a-text>

      <a-box id="virtualNutritionBarVitaminC" position='0.7 0.5 -1.5' depth="0.2" height="1" width="0.2" color="#4CC3D9" visible="false"></a-box>
      <a-text id="virtualNutritionBarVitaminCNumber" position="0.4 1.5 -1.5" rotation="-45 0 0" value="70 mg" color="#D05A6E" visible="false"></a-text>

    </a-marker>

    <!-- camera -->
    <a-entity camera look-controls > 
      <a-cursor geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.015;" material="color: #FFC0CB; shader: flat"></a-cursor>
    </a-entity>
  </a-entity>
  <a-box position="0 0 -5" reset-on-click="" depth="0.1" height="0.1" width="0.1" color="peachpuff"></a-box>

</a-scene>


<script>
  var socket = io.connect('https://192.168.0.101:3000',{secure: true});
    //Get AR scene
    var sceneEl = document.querySelector('a-scene');
    var maxDepth = 1; 
    var xPosition = [-0.55, -0.3, 0, 0.3, 0.55];
    var yPosition = 1;
    var maxConsumption = 1000;
    var historyDays = 5; 
    var weightTextZeroPostion = 0.8;
    var numberofFoodSelected = 0;
    var nutritionMaxDataPoints = 5;
    var simulateWeightNumber =["#simulateMilkWeight", "#simulateOrangeWeight", "#simulateMeatWeight", "#simulateBroccoliWeight", "#simulateFishWeight"];
    var dailyIntakeMax =[1500, 3000, 105, 84, 135];
    var nutritionUnit = [" mg", " Cal", " g", " g", " mg"];
    var nutrionAmountText = ["#calciumAmount", "#caloriesAmount", "#fatAmount", "#proteinAmount", "#vitaminCAmount"];
    var nutritionTag = ["#milkNutrition", "#orangeNutrition", "#meatNutrition", "#broccoliNutrition", "#fishNutrition"];
    var nutritiontagText = ["#milkNutritionText", "#orangeNutritionText", "#meatNutritionText", "#broccoliNutritionText", "#fishNutritionText"];
    var nutritiontagNumberText = ["#milkNutritionNumberText", "#orangeNutritionNumberText", "#meatNutritionNumberText", "#broccoliNutritionNumberText", "#fishNutritionNumberText"];
    var highlightColor = "#FCE300";
    var disHighlightColorBar = "#4CC3D9";
    var disHighlightColorText = "#D05A6E";
    var virtualBarTag = ["#virtualNutritionBarCalcium","#virtualNutritionBarCalories","#virtualNutritionBarFat","#virtualNutritionBarProtein","#virtualNutritionBarVitaminC"];
    var virtualBarNumnerTag = ["#virtualNutritionBarCalciumNumber","#virtualNutritionBarCaloriesNumber","#virtualNutritionBarFatNumber","#virtualNutritionBarProteinNumber","#virtualNutritionBarVitaminCNumber"];
    var virtualBarX = 0.7;
    var virtualZ = -1.5;
    var virtualTextX = [0.2, 0.2, 0.45, 0.45, 0.4];
    var virtualMaxHeight = 4.8;



    function showHistoryView(historyData, tagBar, tagText, tagNumberText, tagPlane){
      for(i = 0; i < Object.keys(historyData).length; i++){
        var depth = Math.round(historyData[i].sumConsumeWeight/1000 * 100) / 100;
        var z = 0.8- depth/2;
        var tag = tagBar + i;
        var textTag = tagText + i;
        var NumberTag= tagNumberText + i;
        var weightString = Math.round(historyData[i].sumConsumeWeight).toString() + " g";
        if(depth == 0){
          sceneEl.querySelector(tag).setAttribute("visible",false); 
          sceneEl.querySelector(textTag).setAttribute("text", {value: historyData[i].date});
          sceneEl.querySelector(textTag).setAttribute("visible",true);
          sceneEl.querySelector(NumberTag).setAttribute("position",{ x: xPosition[i], y: yPosition, z: weightTextZeroPostion });
          sceneEl.querySelector(NumberTag).setAttribute("text", {value: "0 g"}); 
          sceneEl.querySelector(NumberTag).setAttribute("visible",true);
        }
        else{
          sceneEl.querySelector(tag).setAttribute("depth",depth); 
          sceneEl.querySelector(tag).setAttribute("position",{ x: xPosition[i], y: yPosition, z: z }); 
          sceneEl.querySelector(tag).setAttribute("visible",true); 
          sceneEl.querySelector(textTag).setAttribute("text", {value: historyData[i].date});
          sceneEl.querySelector(textTag).setAttribute("visible",true);  
          var numberTextZ = z - depth/2 - 0.1; 
          sceneEl.querySelector(NumberTag).setAttribute("position",{ x: xPosition[i], y: yPosition, z: numberTextZ });
          sceneEl.querySelector(NumberTag).setAttribute("text", {value: weightString}); 
          sceneEl.querySelector(NumberTag).setAttribute("visible",true);
        }    
      }
      // sceneEl.querySelector(tagPlane).setAttribute("visible",true);
    }

    function hideHistoryView(tagBar, tagText, tagNumberText, tagPlane){
      for(i =0; i < historyDays; i++){
        var tag = tagBar + i;
        var textTag = tagText + i;
        var NumberTag = tagNumberText +i;
        sceneEl.querySelector(tag).setAttribute("visible",false); 
        sceneEl.querySelector(textTag).setAttribute("visible",false); 
        sceneEl.querySelector(NumberTag).setAttribute("visible",false);
      }
      // sceneEl.querySelector(tagPlane).setAttribute("visible",false); 
    }

    // Show all the food nutrition each specific nutrients contribution
    function showAllNutritionView(nutritionData, index){
      console.log(nutritionData);
      for(i = 0; i < nutritionData.length; i++){
        var depth = Math.round(nutritionData[i]/dailyIntakeMax[i] * 100) / 100;
        var z = 0.8- depth/2;
        var tag = nutritionTag[index] + i;
        var textTag = nutritiontagText[index] + i;
        var NumberTag= nutritiontagNumberText[index] + i;
        var amountString = (nutritionData[i].toFixed(2)).toString() + nutritionUnit[i];
        console.log(amountString);
        if(depth == 0){
          sceneEl.querySelector(tag).setAttribute("visible",false); 
          sceneEl.querySelector(textTag).setAttribute("visible",true);
          sceneEl.querySelector(NumberTag).setAttribute("position",{ x: xPosition[index], y: yPosition, z: weightTextZeroPostion });
          sceneEl.querySelector(NumberTag).setAttribute("text", {value: "0" + nutritionUnit[i]}); 
          sceneEl.querySelector(NumberTag).setAttribute("visible",true);
        }
        else{
          sceneEl.querySelector(tag).setAttribute("depth", depth); 
          sceneEl.querySelector(tag).setAttribute("position",{ x: xPosition[index], y: yPosition, z: z }); 
          sceneEl.querySelector(tag).setAttribute("visible",true); 
          sceneEl.querySelector(textTag).setAttribute("visible",true); 
          var numberTextZ = z - depth/2 - 0.1; 
          sceneEl.querySelector(NumberTag).setAttribute("position",{ x: xPosition[index], y: yPosition, z: numberTextZ});
          sceneEl.querySelector(NumberTag).setAttribute("text", {value: amountString}); 
          sceneEl.querySelector(NumberTag).setAttribute("visible",true);
        } 
      } 
    }

    function showAllNutrition(milk, orange, meat, broccoli, fish){
      showAllNutritionView(milk, 0);
      showAllNutritionView(orange, 1);
      showAllNutritionView(meat, 2);
      showAllNutritionView(broccoli, 3);
      showAllNutritionView(fish, 4);
    }

    // Show all the food nutrition each specific nutrients contribution
    function hideAllNutritionView(index){
      for(i = 0; i < nutritionMaxDataPoints; i++){
        var tag = nutritionTag[index] + i;
        var textTag = nutritiontagText[index] + i;
        var NumberTag= nutritiontagNumberText[index] + i;
        sceneEl.querySelector(tag).setAttribute("visible",false); 
        sceneEl.querySelector(textTag).setAttribute("visible",false); 
        sceneEl.querySelector(NumberTag).setAttribute("visible",false);
      } 
    }

    function checkIfFoodIsSelected(index){
      if(numberofFoodSelected === 0 ){
        hideAllNutritionView(0);
        hideAllNutritionView(1);
        hideAllNutritionView(2);
        hideAllNutritionView(3);
        hideAllNutritionView(4);
      }
      else{
        disHighlightNutrtionView(index);
      }
    }

    // Hightlight a specific food nutrients contribution 
    function highlightNutrtionView(nutritionData, index){
      for(i = 0; i < nutritionData.length; i++){
        var depth = Math.round(nutritionData[i]/dailyIntakeMax[i] * 100) / 100;
        var tag = nutritionTag[index] + i;
        var textTag = nutritiontagText[index] + i;
        var NumberTag= nutritiontagNumberText[index] + i;
        if(depth == 0){
          sceneEl.querySelector(textTag).setAttribute("text", {color: highlightColor});
          sceneEl.querySelector(NumberTag).setAttribute("text", {color: highlightColor});
        }
        else{
          sceneEl.querySelector(tag).setAttribute("color", highlightColor); 
          sceneEl.querySelector(textTag).setAttribute("text", {color: highlightColor});  
          sceneEl.querySelector(NumberTag).setAttribute("text", {color: highlightColor});
        }    
      }
    }

    // DisHightlight a specific food nutrients contribution 
    function disHighlightNutrtionView(index){
      for(i = 0; i < nutritionMaxDataPoints; i++){
        var tag = nutritionTag[index] + i;
        var textTag = nutritiontagText[index] + i;
        var NumberTag= nutritiontagNumberText[index] + i;
        sceneEl.querySelector(tag).setAttribute("color", disHighlightColorBar); 
        sceneEl.querySelector(textTag).setAttribute("text", {color: disHighlightColorText});  
        sceneEl.querySelector(NumberTag).setAttribute("text", {color: disHighlightColorText});
      }
    }

    // Set virtual bar and number text 
    function setVirtualNutrionBarAndText(virtualNutritionConsumption){
      for(i = 0; i < virtualNutritionConsumption.length; i++){
        // Set height with a percentage of virtualMaxHeight
        var height = Math.round(virtualNutritionConsumption[i]/dailyIntakeMax[i] * 100) / 100 * virtualMaxHeight;
        var y = height/2;
        var tag = virtualBarTag[i];
        var NumberTag= virtualBarNumnerTag[i]
        var amountString = (virtualNutritionConsumption[i].toFixed(2)).toString() + nutritionUnit[i];
        if(height == 0){
          sceneEl.querySelector(tag).setAttribute("visible",false); 
          sceneEl.querySelector(NumberTag).setAttribute("position",{ x: virtualBarX, y: 0.2, z: virtualZ });
          sceneEl.querySelector(NumberTag).setAttribute("value", "0" + nutritionUnit[i]); 
          sceneEl.querySelector(NumberTag).setAttribute("visible",true);
        }
        else{
          sceneEl.querySelector(tag).setAttribute("height", height); 
          sceneEl.querySelector(tag).setAttribute("position",{ x: virtualBarX, y: y, z: virtualZ }); 
          sceneEl.querySelector(tag).setAttribute("visible",true); 
          var textY = y + height/2 + 0.15;
          sceneEl.querySelector(NumberTag).setAttribute("position",{ x: virtualTextX[i], y: textY, z: virtualZ});
          sceneEl.querySelector(NumberTag).setAttribute("value", amountString); 
          sceneEl.querySelector(NumberTag).setAttribute("visible",true);
        } 
      } 
    }

    // Hide all the virtual bars when reset is clicked
    function hideVirtualBarAndText(){
      for(i = 0; i < nutritionMaxDataPoints; i++){
        var tag = virtualBarTag[i];
        var NumberTag= virtualBarNumnerTag[i]
        sceneEl.querySelector(tag).setAttribute("visible",false); 
        sceneEl.querySelector(NumberTag).setAttribute("visible",false); 
      }
    }


    // Set nutrion amount text
    function setNutritionAmount(nutritionArray){
      for(i = 0; i < nutritionArray.length; i++){
       var tag = nutrionAmountText[i];
       var amountString = (nutritionArray[i].toFixed(2)).toString() + nutritionUnit[i];
       sceneEl.querySelector(tag).setAttribute("value", amountString); 
     }
   }


    // Milk selection show detailed information
    socket.on('milkIsSelected', function(milkHistoryData, milk, orange, meat, broccoli, fish){
      showHistoryView(milkHistoryData, "#milkHistory", "#milkHistoryText", "#milkHistoryNumberText", "#milkPlane");
      numberofFoodSelected += 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      showAllNutrition(milk, orange, meat, broccoli, fish);
      console.log(milk);
      console.log(orange);
      highlightNutrtionView(milk, 0);
    });

    socket.on('milkIsDeselected', function(txt){
      hideHistoryView("#milkHistory", "#milkHistoryText", "#milkHistoryNumberText", "#milkPlane");
      numberofFoodSelected -= 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      checkIfFoodIsSelected(0);
    });

    // Orange selection show detailed information
    socket.on('orangeIsSelected', function(orangeHistoryData, milk, orange, meat, broccoli, fish){
      showHistoryView(orangeHistoryData, "#orangeHistory", "#orangeHistoryText", "#orangeHistoryNumberText", "#orangePlane");  
      numberofFoodSelected += 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      showAllNutrition(milk, orange, meat, broccoli, fish);
      highlightNutrtionView(orange, 1);  
    });

    socket.on('orangeIsDeselected', function(txt){
      hideHistoryView("#orangeHistory", "#orangeHistoryText", "#orangeHistoryNumberText", "#orangePlane"); 
      numberofFoodSelected -= 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      checkIfFoodIsSelected(1);    
    });

    // Meat selection show detailed information
    socket.on('meatIsSelected', function(meatHistoryData, milk, orange, meat, broccoli, fish){
      showHistoryView(meatHistoryData, "#meatHistory", "#meatHistoryText", "#meatHistoryNumberText", "#meatPlane");
      numberofFoodSelected += 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      showAllNutrition(milk, orange, meat, broccoli, fish);
      highlightNutrtionView(meat, 2);
    });

    socket.on('meatIsDeselected', function(txt){ 
      hideHistoryView("#meatHistory", "#meatHistoryText", "#meatHistoryNumberText", "#meatPlane"); 
      numberofFoodSelected -= 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      checkIfFoodIsSelected(2);
    });

    // Broccoli selection show detailed information
    socket.on('broccoliIsSelected', function(broccoliHistoryData, milk, orange, meat, broccoli, fish){  
      showHistoryView(broccoliHistoryData, "#broccoliHistory", "#broccoliHistoryText", "#broccoliHistoryNumberText", "#broccoliPlane");
      numberofFoodSelected += 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      showAllNutrition(milk, orange, meat, broccoli, fish);
      highlightNutrtionView(broccoli, 3);
      // socket.emit('broccoliWeightByMovingRack', 90);
    });

    socket.on('broccoliIsDeselected', function(txt){ 
      hideHistoryView("#broccoliHistory", "#broccoliHistoryText", "#broccoliHistoryNumberText", "#broccoliPlane");
      numberofFoodSelected -= 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      checkIfFoodIsSelected(3);
      // socket.emit('broccoliWeightByMovingRack', 80);
    });

    // Fish selection show detailed information
    socket.on('fishIsSelected', function(fishHistoryData, milk, orange, meat, broccoli, fish){
      showHistoryView(fishHistoryData, "#fishHistory", "#fishHistoryText", "#fishHistoryNumberText", "#fishPlane");
      numberofFoodSelected += 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      showAllNutrition(milk, orange, meat, broccoli, fish);
      highlightNutrtionView(fish, 4);
    });

    socket.on('fishIsDeselected', function(txt){ 
      hideHistoryView("#fishHistory", "#fishHistoryText", "#fishHistoryNumberText", "#fishPlane");
      numberofFoodSelected -= 1;
      console.log("numberofFoodSelected " + numberofFoodSelected);
      checkIfFoodIsSelected(4);
    });


    // Show milk weight in AR from scale
    socket.on('scaleDataMilk', function(milk){
      var weight = Math.round(milk.toString()) + " g";
      sceneEl.querySelector('#milkWeight').setAttribute('value', weight);
    });

    // Show orange weight in AR from scale
    socket.on('scaleDataOrange', function(orange){
      var weight = Math.round(orange.toString()) + " g";
      sceneEl.querySelector('#orangeWeight').setAttribute('value', weight);
    }); 

    // Show meat weight in AR from scale
    socket.on('scaleDataMeat', function(meat){
      var weight = Math.round(meat.toString()) + " g";
      sceneEl.querySelector('#meatWeight').setAttribute('value', weight);
    });

    // Show broccoli weight in AR from scale
    socket.on('scaleDataBroccoli', function(broccoli){
      var weight = Math.round(broccoli.toString()) + " g";
      sceneEl.querySelector('#broccoliWeight').setAttribute('value', weight);
    });

    // Show fish weight in AR from scale
    socket.on('scaleDataFish', function(fish){
      var weight = Math.round(fish.toString()) + " g";
      sceneEl.querySelector('#fishWeight').setAttribute('value', weight);
    });


    // When nutrition changes, set nutrition value
    socket.on('nutritionChanges',function(nutritionArray){
      setNutritionAmount(nutritionArray);
    });


    // Show manually changed weight of milk in AR
    socket.on('manualDataMilk', function(virtualMilkWeight, virtualNutritionConsumption){
      var weight = Math.round(virtualMilkWeight.toString()) + " g";
      sceneEl.querySelector('#simulateMilkWeight').setAttribute('value', weight);
      setVirtualNutrionBarAndText(virtualNutritionConsumption);
    });

    // Show manually changed weight of orange in AR
    socket.on('manualDataOrange', function(virtualOrangeWeight, virtualNutritionConsumption){
      var weight = Math.round(virtualOrangeWeight.toString()) + " g";
      sceneEl.querySelector('#simulateOrangeWeight').setAttribute('value', weight);
      setVirtualNutrionBarAndText(virtualNutritionConsumption);
    });

    // Show manually changed weight of meat in AR
    socket.on('manualDataMeat', function(virtualMeatWeight, virtualNutritionConsumption){
      var weight = Math.round(virtualMeatWeight.toString()) + " g";
      sceneEl.querySelector('#simulateMeatWeight').setAttribute('value', weight);
      setVirtualNutrionBarAndText(virtualNutritionConsumption);
    });

    // Show manually changed weight of broccoli in AR
    socket.on('manualDataBroccoli', function(virtualBroccoliWeight, virtualNutritionConsumption){
      var weight = Math.round(virtualBroccoliWeight.toString()) + " g";
      sceneEl.querySelector('#simulateBroccoliWeight').setAttribute('value', weight);
      setVirtualNutrionBarAndText(virtualNutritionConsumption);
    });

    // Show manually changed weight of fish in AR
    socket.on('manualDataFish', function(virtualFishWeight, virtualNutritionConsumption){
      var weight = Math.round(virtualFishWeight.toString()) + " g";
      sceneEl.querySelector('#simulateFishWeight').setAttribute('value', weight);
      setVirtualNutrionBarAndText(virtualNutritionConsumption);
    });

    // Hide the virtual scene again, because the distance secne will always on to measure 
    socket.on('resetVirutalSceneAgain', function(data){
      hideVirtualBarAndText();
      resetVirtualWeight();
    });

    // Reset virtual scene
    function resetVirtualScene(){
      socket.emit('resetVirtualVariables', true);
      socket.emit('resetweightScale', true);
      hideVirtualBarAndText();
    }

    function resetVirtualWeight(){
      for(i = 0; i< simulateWeightNumber.length; i++){
         sceneEl.querySelector(simulateWeightNumber[i]).setAttribute('value', "0 g");
      }
    }


    // If content updates, get all the content again
    socket.on('update content', function(data){
      var buffer = new Uint8Array(data);
      var fileString= String.fromCharCode.apply(null, buffer);
      var obj = JSON.parse(fileString)
      console.log(obj);
      for (i = 0; i < obj.length; i++) {
        $('#messages').append($('<li>').text(obj[i].ID));   
      }    
    });

    // Get the intial content when connected for the first time
    socket.on('initial content', function(data){
      var buffer = new Uint8Array(data);
      var fileString= String.fromCharCode.apply(null, buffer);
      var obj = JSON.parse(fileString)
      for (i = 0; i < obj.length; i++) {
        $('#messages').append($('<li>').text(obj[i].ID));
      }
    });

  </script>
</body>
</html>